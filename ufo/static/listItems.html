<link rel="import" href="bower_components/iron-ajax/iron-ajax.html" />
<link rel="import" href="bower_components/paper-item/paper-item.html" />
<link rel="import" href="bower_components/paper-listbox/paper-listbox.html" />>
<link rel="import" href="bower_components/paper-spinner/paper-spinner.html" />

<dom-module id="list-items">
  <style>
    .first-div {
      width: 300px;
    }
    .second-div {
      width: 250px;
    }
    .third-div {
      width: 200px;
    }
  </style>
  <template>
    <template is="dom-if" if="{{loading}}">
      <paper-spinner active$={{loading}}></paper-spinner>
    </template>
    <iron-ajax auto
      url="{{resources.listUrl}}"
      method="GET"
      handle-as="json"
      id="getItemsAjax"
      loading="{{loading}}"
      last-response="{{ajaxResponse}}">
    </iron-ajax>
    <paper-listbox id="item-list">
      <template is="dom-repeat" items="[[_limitToTen(ajaxResponse.items)]]">
        <paper-icon-item id="{{item.name}}" class="horizontal layout around-justified">
          <template is="dom-if" if="{{resources.isUser}}">
            <div class="first-div">{{item.name}}</div>
            <div class="second-div">{{item.email}}</div>
            <div class="third-div">{{item.access}}</div>
          </template>
          <template is="dom-if" if="{{resources.isProxyServer}}">
            <div class="first-div">{{item.name}}</div>
            <div class="second-div">{{item.ip_address}}</div>
            <div class="third-div"></div>
          </template>
          <iron-icon src="{{resources.itemIconUrl}}" item-icon></iron-icon>
          <paper-icon-button icon="expand-more" title="user details" id="user-details-dropdown"></paper-icon-button>
        </paper-icon-item>
      </template>
    </paper-listbox>
  </template>

  <script>
    Polymer({
      is: 'list-items',
      properties: {
        resources: {
          type: Object,
        },
      },
      _limitToTen: function(array) {
        if (!array || array.length < 10) {
          return array;
        } else {
          return array.slice(0, 10);
        }
      },
    });
  </script>
</dom-module>
